# ETL-процесс и расчёт отчетной формы 101

## Описание проекта
Данный репозиторий содержит реализацию практической работы, посвящённой проектированию и разработке ETL-процессов для банковских данных с использованием PostgreSQL, SQL и Python.

В рамках работы:
- реализована загрузка исторических данных из CSV-файлов в детальный слой хранилища (DS);
- рассчитаны витрины оборотов и остатков (DM);
- сформирована отчетная форма 101 за январь 2018 года;
- выполнен экспорт и импорт итоговых данных в формате CSV.

Проект демонстрирует не только работу с данными и SQL, но и построение автономных, повторно запускаемых ETL-процессов с логированием.

## Используемые технологии
- **PostgreSQL**
- **Python 3**
- **DBeaver**
- SQL (DDL, DML, хранимые процедуры)
- CSV
  
## Структура репозитория
HW_bankdb/
- `task_1.1/` - загрузка данных из CSV в детальный слой (DS)
- `task_1.2/` - расчёт витрин оборотов и остатков (DM)
- `task_1.3/` - расчёт отчетной формы 101
- `task_1.4/` - экспорт и импорт формы 101 в CSV
- `csv_files/` - исходные CSV-файлы
- `config.py` - конфигурация подключения к БД
- `requirements.txt`
- `README.md`

Каждая папка с заданием содержит собственный `README.md` с подробным описанием реализации и инструкциями по запуску.

## Краткое описание заданий

### Задание 1.1 — Загрузка данных в детальный слой (DS)
- Загрузка банковских данных из CSV-файлов в PostgreSQL
- Поддержка различных форматов дат
- Использование UPSERT-логики
- Логирование всех этапов ETL
- Очистка и перезагрузка таблицы проводок

Папка: `task_1.1`

### Задание 1.2 — Расчёт витрин оборотов и остатков
- Расчёт витрины оборотов по лицевым счетам
- Расчёт витрины остатков с учётом типа счета (активный/пассивный)
- Использование хранимых процедур PostgreSQL
- Возможность повторного запуска расчётов
- Логирование выполнения процедур

Папка: `task_1.2`

### Задание 1.3 — Расчёт отчетной формы 101
- Формирование отчетной формы 101 за январь 2018 года
- Агрегация данных по балансовым счетам второго порядка
- Раздельный расчёт рублевых и валютных счетов
- Логирование процесса расчёта
- Поддержка повторного перерасчёта

Папка: `task_1.3`

### Задание 1.4 — Экспорт и импорт данных в CSV
- Экспорт данных формы 101 в CSV-файл с заголовками
- Импорт данных обратно в БД в копию таблицы
- Возможность изменения данных в CSV перед загрузкой
- Простое логирование операций экспорта и импорта

Папка: `task_1.4`

## Установка зависимостей

Для работы с Python-скриптами необходимо установить зависимости:
```bash
pip install -r requirements.txt
```

## Демонстрация работы
Для каждого задания записано демонстрационное видео с пояснениями:
- создание таблиц и процедур;
- запуск ETL-процессов;
- расчёт витрин и отчетов;
- демонстрация логирования;
- экспорт и импорт данных.

Ссылки на видео находятся в файлах video_link*.txt внутри соответствующих папок заданий.

## Итог
В рамках практической работы реализован полноценный цикл обработки данных:
- от загрузки исходных файлов,
- до формирования регламентированной банковской отчетности.

Проект успешно защищён и получил высокую положительную оценку.
